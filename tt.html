<script>

function parseURL (url) {
    url.match(/(http:|https:|)\/\/(player.|www.|m.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/);
    if (RegExp.$3.indexOf('youtu') > -1) {
        var type = 'youtube';
    } else if (RegExp.$3.indexOf('vimeo') > -1) {
        var type = 'vimeo';
    }
    return {
        type: type,
        id: RegExp.$6
    };
}

var getVideoPreviewImg = (function(e, cb) {
  var videoDetails = parseURL(e);
  var videoType = videoDetails.type;
  var videoID = videoDetails.id;

  if (videoType == 'youtube') {
    var thumbSRC = 'https://img.youtube.com/vi/' + videoID + '/0.jpg';
    cb(thumbSRC)
  }
  else if (videoType == 'vimeo') {
    var xhr = new XMLHttpRequest();
    xhr.open("GET", "https://vimeo.com/api/v2/video/"+ videoID +".json", true);
    xhr.onload = function (e) {
      if (xhr.readyState === 4) {
        if (xhr.status === 200) {
          var data = xhr.responseText;
          var parsedData = JSON.parse(data);
          thumbSRClarge = parsedData[0].thumbnail_large;
          // split url of large thumbnail at 640
          thumbSplit = thumbSRClarge.split(/\d{3}(?=.jpg)/);
          // add 1280x720 to parts and get bigger thumbnail
          thumbSRC = thumbSplit[0] + '1280x720' + thumbSplit[1];
          cb(thumbSRC)
        } else {
          console.error(xhr.statusText);
        }
      }
    };
    xhr.onerror = function (e) {
      console.error(xhr.statusText);
    };
    xhr.send(null);
  }
});

getVideoPreviewImg('https://vimeo.com/205367277', function(responseText) {
   console.log(">",responseText)
});

</script>
