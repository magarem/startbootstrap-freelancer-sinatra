<style type="text/css">
  .centro {
   /* centraliza na horizontal */
    -ms-justify-content: center;
    -webkit-justify-content: center;
    justify-content: center;  
  }
 .free-wall {
        margin: 15px;
      }
      .brick img {
        margin: 0;
        display: block;
      }
</style>
<div ng-controller="imgGridCtrl">
 <section id="portfolio" >
    <div class="container">
       <div class="row">
          <div class="col-lg-12 text-center">
            <h2>
             <div contenteditable="<%=@edit_flag%>"
               ng-model="site.pages.portfolio.label"
               strip-br="true"
               select-non-editable="true"
               ng-blur="saveDiv('site.pages.portfolio.label')">
             </div>                
            </h2>
            <hr class="star-primary">                
          </div>
       </div>
       
       <div class="row">
         <div class="text-center">
         <!--  <ul>
            <li ng-repeat="cat in imageCategories">
              <a href ng-click="catselect.cat = cat">{{cat}}//</a></li>
          </ul> -->

          <button ng-show="imageCategories.length > 0" class="btn btn-primary" ng-click="filtraZero()">Todas</button>
          <button ng-show="imageCategories.length > 0" class="btn btn-primary" style="margin: 5px;" ng-repeat="cat in imageCategories" ng-click="$parent.catselect = cat"> {{cat}} </button>
        
         </div>
       </div>
       <% if @edit_flag == true %>
         <button type="button" class="btn btn-default" ng-click="portfolio_add()">+</button>
       <% end %>
       <div class="clearfix"></div>
       <br />
       <style>
          .crop {
            width: 360px;
            height: 260px;
            overflow: hidden;
          }
          .resize-img {
           max-width: 100%;
           height: 260px;
            overflow: hidden;
          }
          .resize-img2 {
           max-width: 100%;
           max-height: 100%;
           overflow: hidden;
          }
          img.resize{
            width:220px; /* you can use % */
            height: auto;
          }
       </style>
       <style type="text/css">
* { box-sizing: border-box; }

/* force scrollbar */
html { overflow-y: scroll; }

body { font-family: sans-serif; }

/* ---- grid ---- */

.grid {
  background: #DDD;
}

/* clear fix */
.grid:after {
  content: '';
  display: block;
  clear: both;
}

/* ---- .grid-item ---- */

.grid-sizer,
.grid-item {
  width: 33.333%;
}

.grid-item {
  float: left;
}

.grid-item img {
  display: block;
  max-width: 100%;
  width: 100%;
}


.cropArea {
            background: #E4E4E4;
            overflow: hidden;
            width: 400px;
            height: 400px;
        }

        img-crop {
            display: block;
            height: 100%;
            overflow: hidden;
            position: relative;
            width: 100%;
        }

        img-crop canvas {
            display: block;
            left: 50%;
            outline: 0 none;
            position: absolute;
            top: 50%;
        }

 </style>

  <div  class="row"  >
    <div class="grid" masonry="true" ng-sortable="barConfig">
      <div class="grid-item"  ng-repeat="image in imgs  | filter:(!!catselect || undefined) && {cat: catselect}" >
         <img ng-src="{{image.img}}" imageonload ng-click="open(image, $index); mostra($index);">
      </div>
    </div>
  </div>


   
 </section>

</div>

<script type="text/ng-template" id="myModalContent.html">
    <div class="modal-body">
       <h2>
         <div contenteditable="<%=@edit_flag%>"
          ng-model="item.titulo"
          strip-br="true"
          select-non-editable="true"
          ng-blur="saveDiv('item.titulo', i)"
          placeholder="Titulo"
          >
         </div>         
       </h2>
       <style>
         .thumb {
            width: 24px;
            height: 24px;
            float: none;
            position: relative;
            top: 7px;
         }
       </style>


       <form name="myForm" ng-controller="MyFormCtrl" ng-init="theImage1 = item.img" >         
          <hr class="star-primary" >
           

 <div class="row" nv-file-drop="" uploader="uploader">
<!-- WITH OPTIONS -->
<table class="table">
                        <thead>
                        <tr>
                            <th width="50%">Name</th>
                            <th ng-show="uploader.isHTML5">Size</th>
                            <th ng-show="uploader.isHTML5">Progress</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="item in uploader.queue">
                            <td>
                              <strong>{{ item.file.name }}</strong>
                                <div class="cropArea_">
                                  <ng-croppie   
                                    src="item.image"
                                    ng-model='item.croppedImage'
                                    update='onUpdate'
                                    boundry="{w: 400, h: 400}"
                                    viewport="{w: 360, h:260}"
                                    mousezoom="true" 
                                    zoom="true" 
                                    type="square">
                                  </ng-croppie>
                                </div>
                        
                            </td>
                            <td ng-show="uploader.isHTML5" nowrap>{{ item.file.size/1024/1024|number:2 }} MB</td>
                            <td ng-show="uploader.isHTML5">
                                <div class="progress" style="margin-bottom: 0;">
                                    <div class="progress-bar" role="progressbar" ng-style="{ 'width': item.progress + '%' }"></div>
                                </div>
                            </td>
                            <td class="text-center">
                                <span ng-show="item.isSuccess"><i class="glyphicon glyphicon-ok"></i></span>
                                <span ng-show="item.isCancel"><i class="glyphicon glyphicon-ban-circle"></i></span>
                                <span ng-show="item.isError"><i class="glyphicon glyphicon-remove"></i></span>
                            </td>
                            <td nowrap>
                                <button type="button" class="btn btn-success btn-xs" ng-click="item.upload()" ng-disabled="item.isReady || item.isUploading || item.isSuccess">
                                    <span class="glyphicon glyphicon-upload"></span> Upload
                                </button>
                                <button type="button" class="btn btn-warning btn-xs" ng-click="item.cancel()" ng-disabled="!item.isUploading">
                                    <span class="glyphicon glyphicon-ban-circle"></span> Cancel
                                </button>
                                <button type="button" class="btn btn-danger btn-xs" ng-click="item.remove()">
                                    <span class="glyphicon glyphicon-trash"></span> Remove
                                </button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
</div>
           
            <input type="file" nv-file-select="" uploader="uploader" multiple />
           
                       
      <% if @edit_flag == true %>        
        <style>
        .progress {
            height: 2em !important;
        }
        </style>
        
      <% end %>
      <p>
        <div contenteditable="{{isLogged}}"
          style = "font-size: 20px;"
          ng-model="item.txt"
          strip-br="true"
          select-non-editable="true"
          ng-blur="saveDiv('item.txt', i)"
          placeholder="Descrição"
          >
        </div>
      </p>
      <ul class="list-inline item-details">         
          <li ng-show="item.cliente || isLogged">Cliente:
             <strong>              
              <div contenteditable="{{isLogged}}"
                ng-model="item.cliente"
                strip-br="true"
                select-non-editable="true"
                ng-blur="saveDiv('item.cliente', i)"
                placeholder="?"
                ></div>
             </strong>
          </li>
          <li ng-show="item.data || isLogged">Data:
              <strong>
               <div contenteditable="{{isLogged}}"
                ng-model="item.data"
                strip-br="true"
                select-non-editable="true"
                ng-blur="saveDiv('item.data', i)"
                placeholder="?">
               </div>
              </strong>
          </li>
          <li ng-show="item.servico || isLogged">Serviço:
              <strong>
                <div contenteditable="{{isLogged}}"
                  ng-model="item.servico"
                  strip-br="true"
                  select-non-editable="true"
                  ng-blur="saveDiv('item.servico', i)"
                  placeholder="?">                  
                </div>
              </strong>
          </li>
          <li ng-show="item.site || isLogged">Site:
              <strong>               
                <div contenteditable="{{isLogged}}"
                  ng-model="item.site"
                  strip-br="true"
                  select-non-editable="true"
                  ng-blur="saveDiv('item.site', i)"
                  placeholder="?">                  
                </div>  
              </strong>
          </li>
           <li ng-show="item.cat || isLogged">Categorias:
              <strong>
              <div contenteditable="{{isLogged}}"
                  ng-model="item.cat"
                  strip-br="true"
                  select-non-editable="true"
                  ng-blur="saveDiv('item.cat', i)"
                  placeholder="?"
                  >                  
                </div>                  
              </strong>
          </li>
      </ul>
      <br>
      <span class="progress" ng-show="picFile.progress >= 0">
        <div style="width:{{picFile.progress}}%" 
            ng-bind="picFile.progress + '%'"></div>
      </span>
      
      <span class="err" ng-show="errorMsg">{{errorMsg}}</span>
      
      <!-- <button type="button" class="btn btn-default" ng-click="uploadPic(picFile, i);">Salvar</button> --> 
      <% if @edit_flag == true %>
        <button type="button" class="btn btn-default" ng-click="excluir(i);">Excluir</button>    
      <% end %>
      <button type="button" class="btn btn-default" ng-click="cancel();"><i class="fa fa-times"></i> Fechar</button>
  </div>
  </form>
</script>
