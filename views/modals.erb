<%= erb :"modals/login" %>
<!-- MODAL -->

<style>
  #modal_alterarEmailESenha {
    height: 450px;
    width: 400px;
    margin: auto;
  }
</style>
<div class="modal fade" id="modal_alterarEmailESenha" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <form method=post id=modal_alterarEmailESenha_form name=modal_alterarEmailESenha_form action="/modal_alterarEmailESenha_form">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Configurações de conta</h5>
      </div>
      <div class="modal-body">
          <div class="form-group">
            <label for="recipient-name" class="form-control-label">E-mail:</label>
            <input type="text" class="form-control" id="modal_alterarEmailESenha_form_email" name=modal_alterarEmailESenha_form_email value="{{siteData.info.email}}">
          </div>
          <div class="form-group">
            <label for="message-text" class="form-control-label">Senha atual: <span style="color: red;">(necessário)</span></label>
            <input type="password" class="form-control" id="modal_alterarEmailESenha_form_senhaAtual" name=modal_alterarEmailESenha_form_senhaAtual>
          </div>
          <div class="form-group">
            <label for="message-text" class="form-control-label">Nova senha:</label>
            <input type="password" class="form-control" id="modal_alterarEmailESenha_form_novaSenha" name=modal_alterarEmailESenha_form_novaSenha>
          </div>
          <div class="form-group">
            <label for="message-text" class="form-control-label">Confirme a nova senha:</label>
            <input type="password" class="form-control" id="modal_alterarEmailESenha_form_novaSenha_confirma" name=modal_alterarEmailESenha_form_novaSenha_confirma>
          </div>
          <span id=modal_alterarEmailESenha_form_msgs style="color:red;"></span>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
        <button type="submit" class="btn btn-primary">Salvar</button>
      </div>
    </div>
  </div>
  </form>
</div>
<script>
  $('#modal_alterarEmailESenha_form').submit(function() {
     //Pegando os valores do formulário
     modal_alterarEmailESenha_form_email = $("#modal_alterarEmailESenha_form_email").val()
     modal_alterarEmailESenha_form_senhaAtual = $("#modal_alterarEmailESenha_form_senhaAtual").val()
     modal_alterarEmailESenha_form_novaSenha = $("#modal_alterarEmailESenha_form_novaSenha").val()
     modal_alterarEmailESenha_form_novaSenha_confirma = $("#modal_alterarEmailESenha_form_novaSenha_confirma").val()

     //Define flag de crítica de formulário
     modal_alterarEmailESenha_form_flag_ok = true
     modal_alterarEmailESenha_form_msg = ""

     if (!modal_alterarEmailESenha_form_email) {
         modal_alterarEmailESenha_form_flag_ok = false
         modal_alterarEmailESenha_form_msg += "Erro: Campo de email vazio<Br>"
     }

     if (!modal_alterarEmailESenha_form_senhaAtual) {
         modal_alterarEmailESenha_form_flag_ok = false
         modal_alterarEmailESenha_form_msg += "Erro: Campo de senha atual vazio<Br>"
     }

     if (modal_alterarEmailESenha_form_novaSenha) {
        if (modal_alterarEmailESenha_form_novaSenha == modal_alterarEmailESenha_form_novaSenha_confirma){
          if (!valida_senha(modal_alterarEmailESenha_form_novaSenha)){
            modal_alterarEmailESenha_form_flag_ok = false
            modal_alterarEmailESenha_form_msg += "Erro: A senha deve ter entre 4 e 15 dígitos<Br>"
          }
        }else{
          //Testa se a senha está dentro do padrão
          modal_alterarEmailESenha_form_flag_ok = false
          modal_alterarEmailESenha_form_msg += "Erro: Campo nova senha e campo nova senha de confirmação estão diferentes<Br>"
        }

     }

     //Confere se o email digitado está correto
     if (!valida_email(modal_alterarEmailESenha_form_email)){
       modal_alterarEmailESenha_form_flag_ok = false
       modal_alterarEmailESenha_form_msg += "Erro: O email digitado está em um formato incorreto<Br>"
     }

     console.log(modal_alterarEmailESenha_form_flag_ok)
     console.log(modal_alterarEmailESenha_form_msg)

     $("#modal_alterarEmailESenha_form_msgs").html(modal_alterarEmailESenha_form_msg);

     return modal_alterarEmailESenha_form_flag_ok

      // return true; // return false to cancel form action
  });
</script>

<style>

  #modal_excluirSite {
    height: 320px;
    width: 400px;
    margin: auto;
  }
</style>
<div class="modal fade" id="modal_excluirSite" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
   <form id=modal_excluirSite_form action="modal_excluirSite" method="post">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Configurações de conta</h5>
      </div>
      <div class="modal-body">
          <div class="form-group">
            <label for="recipient-name" class="form-control-label">Seu site será permanentemente excluído de nossos servidores. Para confirmar essa operação digite sua senha de acesso:</label>
            <input type="password" class="form-control" id="modal_excluirSite_form_senha" name=modal_excluirSite_form_senha>
            <span id=modal_excluirSite_form_msgs style="color:red;"></span>
          </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
        <button type="submit" class="btn btn-primary">Ok</button>
      </div>
    </div>
   </form>
  </div>
</div>
<script>
  $('#modal_excluirSite_form').submit(function() {
     //Pegando os valores do formulário
     modal_excluirSite_form_senha = $("#modal_excluirSite_form_senha").val()

     //Define flag de crítica de formulário
     modal_excluirSite_form_flag_ok = true
     modal_excluirSite_form_msg = ""

     if (!modal_excluirSite_form_senha) {
         modal_excluirSite_form_flag_ok = false
         modal_excluirSite_form_msg += "Erro: Campo senha está vazio<Br>"
     }

     $("#modal_excluirSite_form_msgs").html(modal_excluirSite_form_msg);

     return modal_excluirSite_form_flag_ok
  });
</script>

<style>
  #modal_backup {
    height: 310px;
    width: 400px;
    margin: auto;
  }
</style>
<div class="modal fade" id="modal_backup" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Baixar cópia de segurança</h5>
      </div>
      <div class="modal-body">
        <form>
          <div class="form-group">
            <label for="recipient-name" class="form-control-label">Confirme sua senha para baixar a cópia de segurança de seu site.</label>
            <input type="text" class="form-control" id="recipient-name">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
        <button type="button" class="btn btn-primary">Ok</button>
      </div>
    </div>
  </div>
</div>

<style>
  #modal_erro {
    height: 320px;
    width: 500px;
    margin: auto;
  }
</style>
<div class="modal fade" id="modal_erro" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">ERRO</h5>
      </div>
      <div class="modal-body">
          <div class="form-group">
              <span id=modal_erro_msgs></span>
          </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
      </div>
    </div>
  </div>
</div>
